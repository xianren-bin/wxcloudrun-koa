import{C as l}from"./method-240c52ff.js";import{l as m}from"./mixins-bd2b1c16.js";import{_ as h}from"../index-eb0c0c80.js";import"./index-7154c37a.js";import"./designer-215c5a37.js";import"./lodash-3ef7b69b.js";const c={name:"componentRealtime",mixins:[m],props:{layer:Object},data(){return{formatter:{},timeStr:"",initStatus:!1,timers:"",iconName:""}},watch:{"formatter.isSwitchOn":{handler(){this.currentTime()},deep:!0},"formatter.endTime":{handler(){this.setAlarm(this.formatter.endTime,()=>{clearInterval(this.timers),this.getTime()})},deep:!0},"iconStyle.isSwitchOnIcon":{handler(){this.layer.iconStyle.isSwitchOnIcon?this.iconName=this.layer.iconStyle.iconName:this.iconName=""},deep:!0}},computed:{textStyle(){let e=l(this.layer.textStyle,this.zoomlevel);return e["is-switch-on-background"]||delete e["background-color"],e},borderStyle(){return l(this.layer.borderStyle,this.zoomlevel)},iconStyle(){return l(this.layer.iconStyle,this.zoomlevel)}},methods:{currentTime(){this.formatter.isSwitchOn?(this.timers,this.timers?(clearInterval(this.timers),this.timers=setInterval(this.getTime,500)):this.timers=setInterval(this.getTime,500)):(clearInterval(this.timers),this.getTime())},setAlarm(e,i){e=new Date(e).getTime();const t=new Date().getTime(),r=e-t;if(r<=0){i();return}return setTimeout(i,r)},getTime(){let e=new Date().getFullYear(),i=(new Date().getMonth()+1).toString().padStart(2,"0"),t=new Date().getDate(),r=new Date().getHours(),s=new Date().getMinutes()<10?"0"+new Date().getMinutes():new Date().getMinutes(),n=new Date().getSeconds()<10?"0"+new Date().getSeconds():new Date().getSeconds(),o=new Date().getDay(),a=["日","一","二","三","四","五","六"][o];if(!this.initStatus){setTimeout(()=>{this.getTime()},500);return}this.formatter.isSwitchOnYear?e=e+this.formatter.unitYear:e="",this.formatter.isSwitchOnMonth?i=i+this.formatter.unitMonth:i="",this.formatter.isSwitchOnDay?t=t+this.formatter.unitDay:t="",this.formatter.isSwitchOnHour?r=r+this.formatter.unitHour:r="",this.formatter.isSwitchOnMinute?s=s+this.formatter.unitMinute:s="",this.formatter.isSwitchOnSecond?n=n+this.formatter.unitSecond:n="",this.formatter.isSwitchOnWeek?a="星期"+a:a="",this.timeStr=e+i+t+" "+r+s+n+" "+a},initial(){return new Promise((e,i)=>{this.RequestData(this.layer.data).then(t=>{this.initStatus=!0,this.insidevalue=t.data,this.formatter=this.layer.formatter,this.iconName=this.layer.iconStyle.iconName,this.setAlarm(this.formatter.endTime,()=>{clearInterval(this.timers),this.getTime()}),e()})})},getVal(){return this.insidevalue},setVal(e){this.insidevalue=e}},mounted(){this.currentTime()},beforeDestory(){clearInterval(this.timers)}};function u(e,i,t,r,s,n){return Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(s.iconName),style:Vue.normalizeStyle([n.iconStyle])},[Vue.createElementVNode("div",{class:"text-container",onClick:i[0]||(i[0]=o=>e.eventFun("click")),style:Vue.normalizeStyle([{"line-height":t.layer.style.height*e.zoomlevel/100-(t.layer.style.border?t.layer.style.border.borderTopWidth:0)-(t.layer.style.border?t.layer.style.border.borderBottomWidth:0)+"px"},n.textStyle,n.borderStyle])},Vue.toDisplayString(s.timeStr),5)],6)}const v=h(c,[["render",u],["__scopeId","data-v-23e36f90"]]);export{v as default};
